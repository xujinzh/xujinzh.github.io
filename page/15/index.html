<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>J. Xu - 众妙之门</title><meta name="author" content="Jinzhong Xu"><meta name="copyright" content="Jinzhong Xu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="众妙之门">
<meta property="og:type" content="website">
<meta property="og:title" content="J. Xu">
<meta property="og:url" content="https://xujinzh.github.io/page/15/index.html">
<meta property="og:site_name" content="J. Xu">
<meta property="og:description" content="众妙之门">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xujinzh.github.io/img/silence.jpg">
<meta property="article:author" content="Jinzhong Xu">
<meta property="article:tag" content="数学、计算机视觉、计算机应用技术">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xujinzh.github.io/img/silence.jpg"><link rel="shortcut icon" href="/img/letter-j.png"><link rel="canonical" href="https://xujinzh.github.io/page/15/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'J. Xu',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-01-31 15:38:46'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/silence.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">384</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">296</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">25</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="J. Xu"><img class="site-icon" src="/img/letter-j.png"/><span class="site-name">J. Xu</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2022/01/21/python-iterable-iterator-generator/" title="Python 中的迭代器和生成器"><img class="post-bg" src="/img/c11.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python 中的迭代器和生成器"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/21/python-iterable-iterator-generator/" title="Python 中的迭代器和生成器">Python 中的迭代器和生成器</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-21T05:53:51.000Z" title="发表于 2022-01-21 13:53:51">2022-01-21</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-30T15:35:56.100Z" title="更新于 2024-01-30 23:35:56">2024-01-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/technology/">technology</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/technology/python/">python</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/python/">python</a></span></div><div class="content">Python 中对象的遍历称为迭代，常用 for 循环和 while 循环等实现。那么有哪些对象可以迭代，它们有什么共同特性呢？本篇对可迭代对象、迭代器和生成器进行介绍。


迭代对于 python 中的 list, tuple, dict, set, str，文件对象等容器（数据的集合，这里不使用集合为了区分 python 中的 set），我们可以使用 for 循环等遍历里面的元素，但没有按照固定的顺序进行：
12for i in set(&quot;a1$.&quot;):    print(i)  # 1 $ a .

对于 C 语言，迭代都是按照索引顺序进行：
123for (i = 0; i &lt; length; i++) &#123;    n = list[i];&#125;

可见，python 的 for 循环的抽象程度是高于 C 的。因此，在 python 中对于没有索引的容器都可以进行迭代。如
12345678910111213d = &#123;&quot;a&quot;: 1, &quot;b&quot;: 2&#125;# 对键进行迭代，对字典迭代默认为 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/01/20/ssh-message-broadcast/" title="SSH 消息聊天与广播"><img class="post-bg" src="/img/c21.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SSH 消息聊天与广播"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/20/ssh-message-broadcast/" title="SSH 消息聊天与广播">SSH 消息聊天与广播</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-20T10:53:47.000Z" title="发表于 2022-01-20 18:53:47">2022-01-20</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-30T15:35:56.104Z" title="更新于 2024-01-30 23:35:56">2024-01-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/technology/">technology</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/technology/computer-science/">computer science</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/ssh/">ssh</a></span></div><div class="content">通过 SSH 连接到远端主机，一般会打开一个伪终端（pts）。Linux 系统是可进行多用户访问，当你访问远端主机时，别人也可能正在进行访问，当我们需要进行远端主机重启等一些影响别人使用远端主机的行为时，我们需要把重启的消失广播给其他用户。


write 消息聊天使用 write 能够在终端上互相聊天，方法如下：
12345678910# 查看当前登录用户whojinzhongxu pts/2        2022-01-20 19:08 (127.0.0.1)jinzhongxu pts/3        2022-01-20 15:37 (10.2.28.40)# 我当前登录使用的是伪终端 pts/3，想发给 pts/2 实时消息# 发送消息，类似于写信，先写发送对象，回车后写内容，一行回车将直接发送信息给对方write jinzhongxu pts/2hello, I will reboot this computer!!!

此时，登录在伪终端 pts&#x2F;3 的用户终端上就会显示我发生的信息。
查看伪终端的方法还有
123tty# 显示伪终端/dev/pts/2

 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/01/20/ssh-forwarding-more/" title="SSH 转发知识汇总"><img class="post-bg" src="/img/c9.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SSH 转发知识汇总"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/20/ssh-forwarding-more/" title="SSH 转发知识汇总">SSH 转发知识汇总</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-20T06:24:00.000Z" title="发表于 2022-01-20 14:24:00">2022-01-20</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-30T15:35:56.104Z" title="更新于 2024-01-30 23:35:56">2024-01-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/technology/">technology</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/technology/computer-science/">computer science</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/ssh/">ssh</a></span></div><div class="content">我这里有个需求，就是如何将公司局域网内的服务器A开发的网站开放到互联网上。公司局域网的服务器A能够通过主路由器访问互联网，但却没有公网 IP，因此，无法在互联网上直接访问A上的网页。通过 SSH 远程端口转发可以实现这一目的。借此，本篇汇总记录一下 SSH 转发的相关知识。本篇以 Ubuntu18.04 为例，所有端口均指 TCP 端口，建议防火墙开放相应的端口，并保证端口没有被占用。


SSH 简介如今，SSH 在 Linux&#x2F;MacOS&#x2F;Windows 上是标配的软件工具。事实上，SSH 是一种网络协议，由芬兰学者 Tatu Ylonen 于 1995 年设计，用于主机之间的加密登录，将登录信息全部加密。现如今，针对该协议开发有各种实现，有商业的，也有开源的，如 OpenSSH 等。
1234# 使用 SSH 以用户 username 登录到主机 host_ip 上ssh username@host_ip# 指定端口登录ssh -p 2222 uername@host_ip

端口可以在 host_ip 上进行修改，方法如下：
123456# 在配置文件中修改 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/01/19/ssh-forwarding-service/" title="SSH 转发的一些记录"><img class="post-bg" src="/img/c25.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SSH 转发的一些记录"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/19/ssh-forwarding-service/" title="SSH 转发的一些记录">SSH 转发的一些记录</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-19T08:32:51.000Z" title="发表于 2022-01-19 16:32:51">2022-01-19</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-30T15:35:56.104Z" title="更新于 2024-01-30 23:35:56">2024-01-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/technology/">technology</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/technology/computer-science/">computer science</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/ssh/">ssh</a></span></div><div class="content">使用 ssh 能够访问远程服务器，但是，对于办公室的电脑只有内网 ip 而无法在家直接通过 ssh 访问，有时候不是很方便，然而像 frp 等都被公司禁止使用。本篇介绍 ssh 转发解决上面的问题。


公网服务器设置首先需要购买一个具有公网 ip 的服务器，这里推荐阿里云，腾讯云等，服务器地址选择当地的就好，比如上海等。然后，对服务器进行配置，开放一个转发的端口，比如，2222。最后，需要对 sshd 的配置文件进行修改。
12345sudo vim /etc/ssh/sshd_config# 添加如下内容GatewayPorts yes# 重启 sshdsudo systemctl restart sshd.service

为什么设置 GatewayPorts yes 呢？这是因为，默认情况下，OpenSSH 只允许从服务器主机连接到远程转发端口。GatewayPorts no 能够防止从服务器计算机外部连接到转发端口。也就是说，只能服务器自己连接自己的端口实现访问内网的端口，而外部的服务器不能连接。其实，查看端口占用（sudo netstat -tunlp | grep 222 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/01/19/python-get-file-size/" title="Python 中如何获取文件的大小"><img class="post-bg" src="/img/c25.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python 中如何获取文件的大小"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/19/python-get-file-size/" title="Python 中如何获取文件的大小">Python 中如何获取文件的大小</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-19T02:54:44.000Z" title="发表于 2022-01-19 10:54:44">2022-01-19</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-30T15:35:56.100Z" title="更新于 2024-01-30 23:35:56">2024-01-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/technology/">technology</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/technology/python/">python</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/python/">python</a></span></div><div class="content">Python 是非常优秀的编程语言，开发效率高。在 Shell 中可以非常方便的使用 ls -l filepath 获得文件的大小，那么在 Python 中如何获取文件的大小呢，下面给出4中方法。假设我们的文件路径是 file_path = &#39;/test-file.txt&#39;.


os.path.getsize使用该函数能够获得文件的大小，单位为字节
123import osos.path.getsize(file_path)

os.stat使用该函数能够获得文件的大小，单位为字节
123import osos.stat(file_path).st_size

打开文件读取文件，获得大小使用该方法能够获得文件的大小，单位为字节
12345import oswith open(file_path, &#x27;rb&#x27;) as f:    f.seek(0, os.SEEK_END)    print(f.tell())

使用 pathlib.Path(file_path).stat()使用该方法能够获得文件的大小，单位为字节
123from pathlib  ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/01/19/jupyterlab-dark-mode-matplotlib-plot/" title="Jupyterlab 暗黑模式下使用 Matplotlib 画图显示问题"><img class="post-bg" src="/img/c24.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Jupyterlab 暗黑模式下使用 Matplotlib 画图显示问题"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/19/jupyterlab-dark-mode-matplotlib-plot/" title="Jupyterlab 暗黑模式下使用 Matplotlib 画图显示问题">Jupyterlab 暗黑模式下使用 Matplotlib 画图显示问题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-19T02:01:05.000Z" title="发表于 2022-01-19 10:01:05">2022-01-19</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-30T15:35:56.096Z" title="更新于 2024-01-30 23:35:56">2024-01-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/technology/">technology</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/technology/python/">python</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/jupyterlab/">jupyterlab</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/matplotlib/">matplotlib</a></span></div><div class="content">Jupyterlab 暗黑模式下使用 Matplotlib 画图有时无法显示图片的坐标轴信息，这是需要调整 matplotlib 的画图显示风格，以使用暗黑模式的 jupyterlab. 本篇所有代码在 jupyterlab 中使用。 


更改 matplotlib 的 stylematplotlib 提供了很多种显示风格，查看所有的风格，可以使用如下命令：
123from matplotlib import stylestyle.available

12345678910111213141516171819202122232425262728[&#x27;Solarize_Light2&#x27;, &#x27;_classic_test_patch&#x27;, &#x27;_mpl-gallery&#x27;, &#x27;_mpl-gallery-nogrid&#x27;, &#x27;bmh&#x27;, &#x27;classic&#x27;, &#x27;dark_background&#x27;, &#x27;fast&#x27;, &#x27;fivethirty ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/01/19/view-log-info-on-linux/" title="在 Linux 系统上查看日志信息"><img class="post-bg" src="/img/c7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="在 Linux 系统上查看日志信息"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/19/view-log-info-on-linux/" title="在 Linux 系统上查看日志信息">在 Linux 系统上查看日志信息</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-19T01:25:57.000Z" title="发表于 2022-01-19 09:25:57">2022-01-19</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-30T15:35:56.108Z" title="更新于 2024-01-30 23:35:56">2024-01-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/technology/">technology</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/technology/linux/">linux</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/log/">log</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/journalctl/">journalctl</a></span></div><div class="content">Linux 系统上有很多服务是使用 systemctl 来管理的，如何查看这些服务的日志信息呢？下面以 Ubuntu 18.04&#x2F;CentOS 7 为例，所有命令以 root 身份运行。


journalctljournalctl 命令是一个管理工具，能够查询 systemd 日志，同时管理、查看由内核、initrd 以及服务等产生的信息。
12345678910# 查看 jupyterhub 的日志信息, -u 表示按单元（--unit）journalctl -u jupyterhub.service# 查看 jupyterhub 的最新的日志信息journalctl -u jupyterhub.service -r# 实时的查看系统查看的最新日志信息，类似于 tail -f journalctl -f# 查看从凌晨到3：20的日志信息journalctl --since &quot;today&quot; --until &quot;3:20&quot;# 查看 journalctl 如何使用man journalctl

日记本身是 systemd 管理的系统服务，全 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/01/15/ip-tcp-udp-header-checksum/" title="ip、tcp、udp 首部校验和算法的 Python 实现"><img class="post-bg" src="/img/c8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ip、tcp、udp 首部校验和算法的 Python 实现"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/15/ip-tcp-udp-header-checksum/" title="ip、tcp、udp 首部校验和算法的 Python 实现">ip、tcp、udp 首部校验和算法的 Python 实现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-15T11:32:50.000Z" title="发表于 2022-01-15 19:32:50">2022-01-15</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-30T15:35:56.096Z" title="更新于 2024-01-30 23:35:56">2024-01-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/technology/">technology</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/technology/computer-science/">computer science</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/ip/">ip</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/tcp/">tcp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/udp/">udp</a></span></div><div class="content">ip 首部校验和、tcp&#x2F;udp 首部校验和能够判断网络传输中是否出现丢包、错包等。下面分别介绍它们的计算方法和 python 实现。



ip 首部校验和ip 首部校验和是针对 ip 数据包的包头20字节部分进行校验。假设我们有如下20字节的 ip 包头数据（16进制格式）：
145 00 00 30 80 4c 40 00 80 06 b5 2e d3 43 11 7b cb 51 15 3d


45：4表示 ip 版本号，这里是 ipv4，5表示首部数据长度，为5个32比特，即20字节；
00 30: 表示 ip 包总长度为 0x0030&#x3D;48字节，减去头部20字节，数据部分为28字节；
80 4c：表示标识符；
40 00：3比特标志和13比特片偏移量；
80 06：80表示ttl值0x80&#x3D;128，06表示 tcp 协议（0x11&#x3D;17表示udp协议）；
b5 2e：表示 ip 首部校验和；
d3 43 11 7b：表示源地址0xd3, 0x43, 0x11, 0x7b &#x3D; (211, 67, 17, 123)；
cb 5 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/01/08/wsl-cron/" title="开启 wsl 上的 cron 服务"><img class="post-bg" src="/img/c22.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="开启 wsl 上的 cron 服务"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/08/wsl-cron/" title="开启 wsl 上的 cron 服务">开启 wsl 上的 cron 服务</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-08T12:57:07.000Z" title="发表于 2022-01-08 20:57:07">2022-01-08</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-30T15:35:56.108Z" title="更新于 2024-01-30 23:35:56">2024-01-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/technology/">technology</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/technology/windows/">windows</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/wsl/">wsl</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/cron/">cron</a></span></div><div class="content">wsl 是 windows 的 linux 子系统，使得在 windows 上使用 linux 非常丝滑，而不用安装虚拟机。但是，有些服务在 wsl 默认是关闭的，需要设置才能使用。下面介绍如何在 wsl ubuntu 上开启使用 cron，cron 能够进行定时任务的执行。


用户添加到 crontab 组命令如下：
1sudo usermod -a -G crontab jinzhongxu

开启 cron 服务123sudo service cron start# 或者sudo /etc/init.d/cron start

设置开机自启 cron 服务访问我的另一篇博文: Windows10 子系统开机自启动SSH等服务，把如下命令添加到 wsl.vbs 中:
1ws.run &quot;wsl -d Ubuntu -u root /etc/init.d/cron start&quot;, vbhide

</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/01/08/fire-wall-linux/" title="linux 防火墙"><img class="post-bg" src="/img/c7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="linux 防火墙"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/08/fire-wall-linux/" title="linux 防火墙">linux 防火墙</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-08T08:38:36.000Z" title="发表于 2022-01-08 16:38:36">2022-01-08</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-31T07:38:15.170Z" title="更新于 2024-01-31 15:38:15">2024-01-31</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/technology/">technology</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/technology/linux/">linux</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/linux/">linux</a></span></div><div class="content">无论是 Windows 系统还是 Linux 系统都有防火墙，防火墙能够防护电脑免受外界攻击，保护电脑安全。本篇介绍如何在 Ubuntu&#x2F;Debian&#x2F;CentOS 上安装和使用防火墙。


Ubuntu&#x2F;Debian 上防火墙安装防火墙
12sudo apt updatesudo apt install ufw

防火墙使用
1234567891011121314151617181920212223242526272829303132# 开启防火墙sudo ufw enable# 查看防火墙状态sudo ufw status# 开启指定端口sudo ufw allow 22# 开启指定端口的tcpsudo ufw allow 22/tcp# 打开端口范围，此时必须指定 tcp 或 udpsudo ufw allow 7000:7070/tcp# 允许指定IP地址sudo ufw allow from xxx.xxx.xxx.xxx# 允许指定IP地址访问指定端口sudo ufw allow from xxx.xxx.xxx.xxx to any port ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/01/03/java-print-multi-variables/" title="java 一条语句打印多个变量"><img class="post-bg" src="/img/c20.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="java 一条语句打印多个变量"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/03/java-print-multi-variables/" title="java 一条语句打印多个变量">java 一条语句打印多个变量</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-03T06:08:28.000Z" title="发表于 2022-01-03 14:08:28">2022-01-03</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-30T15:35:56.096Z" title="更新于 2024-01-30 23:35:56">2024-01-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/technology/">technology</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/technology/java/">java</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/java/">java</a></span></div><div class="content">在 java 程序中，想要通过一条语句打印输出多个变量的值，就像在 python 中那样，将变量以逗号分隔罗列到 print 函数中是不行的，在 java 中可以使用如下方法。


字符串拼接和占位符
通过字符串拼接在函数 System.out.println() 中；
通过占位符在函数 System.out.printf() 中；

12345678910111213141516public class Main &#123;    public static void main(String[] args) &#123;        System.out.println(&quot;Hello World!&quot;);        int i = 2147483647;        int i2 = -2147483648;        int i3 = 2_000_000;        int i4 = 0xff0000;        int i5 = 0b1000000000;        long l = 9000000000000000000L;      ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/14/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/#content-inner">14</a><span class="page-number current">15</span><a class="page-number" href="/page/16/#content-inner">16</a><span class="space">&hellip;</span><a class="page-number" href="/page/35/#content-inner">35</a><a class="extend next" rel="next" href="/page/16/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/silence.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Jinzhong Xu</div><div class="author-info__description">众妙之门</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">384</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">296</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">25</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xujinzh"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xujinzh" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:xujinzhong027@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.mathscv.com" target="_blank" title="MathsCVBlog"><i class="fab fa-j"></i></a><a class="social-icon" href="https://xujinzh.github.io" target="_blank" title="GitHubBlog"><i class="fab fa-github-alt"></i></a><a class="social-icon" href="https://www.mathscv.com/power" target="_blank" title="MathsCVPower"><i class="fab fa-m"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">日本核污染水强排入海！</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/01/27/linux-grep/" title="linux 三剑客 - 文本查找命令 grep"><img src="/img/c25.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="linux 三剑客 - 文本查找命令 grep"/></a><div class="content"><a class="title" href="/2024/01/27/linux-grep/" title="linux 三剑客 - 文本查找命令 grep">linux 三剑客 - 文本查找命令 grep</a><time datetime="2024-01-27T10:04:18.000Z" title="发表于 2024-01-27 18:04:18">2024-01-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/21/ai-internlm-opencompass/" title="基于 OpenCompass 的大模型评测"><img src="/img/c22.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="基于 OpenCompass 的大模型评测"/></a><div class="content"><a class="title" href="/2024/01/21/ai-internlm-opencompass/" title="基于 OpenCompass 的大模型评测">基于 OpenCompass 的大模型评测</a><time datetime="2024-01-21T05:36:33.000Z" title="发表于 2024-01-21 13:36:33">2024-01-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/17/python-torch-multi-gpu-py/" title="Python 多进程使用单机多GPU加速推理"><img src="/img/c16.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python 多进程使用单机多GPU加速推理"/></a><div class="content"><a class="title" href="/2024/01/17/python-torch-multi-gpu-py/" title="Python 多进程使用单机多GPU加速推理">Python 多进程使用单机多GPU加速推理</a><time datetime="2024-01-17T06:53:55.000Z" title="发表于 2024-01-17 14:53:55">2024-01-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/13/ai-internlm-lmdeploy/" title="基于 LMDeploy 的大模型量化和部署"><img src="/img/c26.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="基于 LMDeploy 的大模型量化和部署"/></a><div class="content"><a class="title" href="/2024/01/13/ai-internlm-lmdeploy/" title="基于 LMDeploy 的大模型量化和部署">基于 LMDeploy 的大模型量化和部署</a><time datetime="2024-01-13T06:07:33.000Z" title="发表于 2024-01-13 14:07:33">2024-01-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/12/ai-internlm-personal-assistant-based-on-xtuner/" title="利用 XTuner 训练书生·浦语私人大模型助手"><img src="/img/c29.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="利用 XTuner 训练书生·浦语私人大模型助手"/></a><div class="content"><a class="title" href="/2024/01/12/ai-internlm-personal-assistant-based-on-xtuner/" title="利用 XTuner 训练书生·浦语私人大模型助手">利用 XTuner 训练书生·浦语私人大模型助手</a><time datetime="2024-01-12T11:03:54.000Z" title="发表于 2024-01-12 19:03:54">2024-01-12</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/maths/"><span class="card-category-list-name">maths</span><span class="card-category-list-count">32</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/maths/algebra/"><span class="card-category-list-name">algebra</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/maths/mathematical-analysis/"><span class="card-category-list-name">mathematical analysis</span><span class="card-category-list-count">22</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/maths/mathematician/"><span class="card-category-list-name">mathematician</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/maths/optimization/"><span class="card-category-list-name">optimization</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/maths/probability/"><span class="card-category-list-name">probability</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/maths/topology/"><span class="card-category-list-name">topology</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/research/"><span class="card-category-list-name">research</span><span class="card-category-list-count">49</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/nvidia/" style="font-size: 1.21em; color: #999ea4">nvidia</a> <a href="/tags/Leibniz/" style="font-size: 1.1em; color: #999">Leibniz</a> <a href="/tags/volume/" style="font-size: 1.1em; color: #999">volume</a> <a href="/tags/storm/" style="font-size: 1.21em; color: #999ea4">storm</a> <a href="/tags/journal/" style="font-size: 1.1em; color: #999">journal</a> <a href="/tags/remote/" style="font-size: 1.1em; color: #999">remote</a> <a href="/tags/opencv/" style="font-size: 1.21em; color: #999ea4">opencv</a> <a href="/tags/graph/" style="font-size: 1.1em; color: #999">graph</a> <a href="/tags/gcc/" style="font-size: 1.16em; color: #999b9e">gcc</a> <a href="/tags/ml/" style="font-size: 1.33em; color: #99a2af">ml</a> <a href="/tags/pyqt5/" style="font-size: 1.1em; color: #999">pyqt5</a> <a href="/tags/dl/" style="font-size: 1.39em; color: #99a4b4">dl</a> <a href="/tags/algebra/" style="font-size: 1.1em; color: #999">algebra</a> <a href="/tags/optimizer/" style="font-size: 1.1em; color: #999">optimizer</a> <a href="/tags/superior/" style="font-size: 1.1em; color: #999">superior</a> <a href="/tags/timm/" style="font-size: 1.1em; color: #999">timm</a> <a href="/tags/npm/" style="font-size: 1.16em; color: #999b9e">npm</a> <a href="/tags/zabbix/" style="font-size: 1.16em; color: #999b9e">zabbix</a> <a href="/tags/extremum/" style="font-size: 1.1em; color: #999">extremum</a> <a href="/tags/youtube-dl/" style="font-size: 1.1em; color: #999">youtube-dl</a> <a href="/tags/rar/" style="font-size: 1.16em; color: #999b9e">rar</a> <a href="/tags/chattr/" style="font-size: 1.1em; color: #999">chattr</a> <a href="/tags/AriaNg/" style="font-size: 1.1em; color: #999">AriaNg</a> <a href="/tags/matplotlib/" style="font-size: 1.21em; color: #999ea4">matplotlib</a> <a href="/tags/neofetch/" style="font-size: 1.1em; color: #999">neofetch</a> <a href="/tags/nsfc/" style="font-size: 1.1em; color: #999">nsfc</a> <a href="/tags/indefinite-integral/" style="font-size: 1.16em; color: #999b9e">indefinite integral</a> <a href="/tags/dict/" style="font-size: 1.1em; color: #999">dict</a> <a href="/tags/ip/" style="font-size: 1.27em; color: #99a0a9">ip</a> <a href="/tags/linx/" style="font-size: 1.1em; color: #999">linx</a> <a href="/tags/acorn/" style="font-size: 1.1em; color: #999">acorn</a> <a href="/tags/debian/" style="font-size: 1.44em; color: #99a7ba">debian</a> <a href="/tags/python/" style="font-size: 1.5em; color: #99a9bf">python</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><span class="card-archive-list-count">16</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/06/"><span class="card-archive-list-date">六月 2023</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">五月 2023</span><span class="card-archive-list-count">5</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">384</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2019-07-16T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">420.6k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-01-31T07:38:44.137Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By Jinzhong Xu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const findTrueUrl = (array) => {
    Promise.all(array.map(item =>
      fetch(item.url).then(resp => resp.json()).then(data => {
        const urlArray = data.body.match(/(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?/ig)
        if (data.user.login === 'utterances-bot') {
          return urlArray.pop()
        } else {
          return urlArray.shift()
        }
      })
    )).then(res => {
        array = array.map((i,index)=> {
          return {
            ...i,
            url: res[index]
          }
        })

        saveToLocal.set('github-newest-comments', JSON.stringify(array), 10/(60*24))
        generateHtml(array)
    });
  }

  const getComment = () => {
    fetch('https://api.github.com/repos/xujinzh/xujinzh.github.io/issues/comments?sort=updated&direction=desc&per_page=6&page=1',{
      "headers": {
        Accept: 'application/vnd.github.v3.html+json'
      }
    })
      .then(response => response.json())
      .then(data => {
        const githubArray = data.map(item => {
          return {
            'avatar': item.user.avatar_url,
            'content': changeContent(item.body_html),
            'nick': item.user.login,
            'url': item.issue_url,
            'date': item.updated_at,
            'githubUrl': item.html_url
          }
        })
        findTrueUrl(githubArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      })
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('github-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="众,妙,之,门" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>